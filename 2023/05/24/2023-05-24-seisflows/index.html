<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="seisflows, erbiaoger">
    <meta name="description" content="





plot codefig1. Fig2.1234567%cd /home/erbiaoger/MyProjects/Seisflows/work/day_3/44/specfem2d_workdir/init = Model(&#39;">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-226HR8SSP2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-226HR8SSP2');
</script>


    <title>seisflows | erbiaoger</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/favicon.png">
    
    <style>
        body{
            background-image: url(/medias/banner/9.jpg);
            background-repeat:no-repeat;
            background-size: 100% 100%;
            background-attachment:fixed;
        }
    </style>



    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/matery.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/my.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/reward.css">
    



    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="erbiaoger" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">erbiaoger</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-index" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle-o" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/music">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Music</span>
        </a>
      </li>
      
      <li>
        <a href="/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Movies</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Books</span>
        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Galleries</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">erbiaoger</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-index"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle-o"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/music " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>Music</span>
                  </a>
                </li>
              
                <li>

                  <a href="/movies " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>Movies</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>Books</span>
                  </a>
                </li>
              
                <li>

                  <a href="/galleries " style="margin-left:75px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:50px" ></i>
			      
		          <span>Galleries</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">seisflows</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/seisflows/">
                                <span class="chip bg-color">seisflows</span>
                            </a>
                        
                            <a href="/tags/inversion/">
                                <span class="chip bg-color">inversion</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-05-24
                </div>
                

                

                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305221714517.png" alt="output"></p>
<p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305221714443.png" alt="output"></p>
<p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305221715062.png" alt="output"></p>
<p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305221715733.png" alt="output"></p>
<p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305232157196.png" alt="output"></p>
<p><img src="https://raw.githubusercontent.com/erbiaoger/PicGo/main/20230404/202305232158319.png" alt="output"></p>
<h2 id="plot-code"><a href="#plot-code" class="headerlink" title="plot code"></a>plot code</h2><h3 id="fig1-Fig2"><a href="#fig1-Fig2" class="headerlink" title="fig1. Fig2."></a>fig1. Fig2.</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">%cd /home/erbiaoger/MyProjects/Seisflows/work/day_3/<span class="number">44</span>/specfem2d_workdir/</span><br><span class="line">init = Model(<span class="string">'OUTPUT_FILES_INIT'</span>)</span><br><span class="line">init.plot2d(<span class="string">'vs'</span>)</span><br><span class="line">true = Model(<span class="string">'OUTPUT_FILES_TRUE'</span>)</span><br><span class="line">true.plot2d(<span class="string">'vs'</span>)</span><br><span class="line"><span class="comment">#true = Model('OUTPUT_FILES')</span></span><br><span class="line"><span class="comment">#true.plot2d('vs')</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="fig3-fig4"><a href="#fig3-fig4" class="headerlink" title="fig3. fig4"></a>fig3. fig4</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">%cd /home/erbiaoger/MyProjects/Seisflows/work/day_3/<span class="number">44</span>/output_1/</span><br><span class="line">m_init = Model(<span class="string">'MODEL_INIT'</span>)</span><br><span class="line">m_true = Model(<span class="string">'MODEL_TRUE'</span>)</span><br><span class="line"><span class="comment">#m_init.save('/home/zhangzhiyu/MyProjects/Seisflows/work/day_3/3/output/m_init.npz')</span></span><br><span class="line"><span class="comment">#m_true.plot2d('vs')</span></span><br><span class="line"></span><br><span class="line">g_01 = Model(<span class="string">'GRADIENT_01'</span>)</span><br><span class="line">g_01.coordinates = {}</span><br><span class="line">g_01.coordinates[<span class="string">"x"</span>] = m_init.coordinates[<span class="string">"x"</span>]</span><br><span class="line">g_01.coordinates[<span class="string">"z"</span>] = m_init.coordinates[<span class="string">"z"</span>]</span><br><span class="line">g_01.plot2d(<span class="string">'vs_kernel'</span>)</span><br><span class="line"></span><br><span class="line">m_01 = Model(<span class="string">'MODEL_01'</span>)</span><br><span class="line">m_01.coordinates = {}</span><br><span class="line">m_01.coordinates[<span class="string">"x"</span>] = m_init.coordinates[<span class="string">"x"</span>]</span><br><span class="line">m_01.coordinates[<span class="string">"z"</span>] = m_init.coordinates[<span class="string">"z"</span>]</span><br><span class="line">m_01.plot2d(<span class="string">'vs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#m_01.save('/home/zhangzhiyu/MyProjects/Seisflows/work/day_3/3/output/m.npz')</span></span><br></pre></td></tr></tbody></table></figure>





<h2 id="parameters-yaml"><a href="#parameters-yaml" class="headerlink" title="parameters.yaml"></a>parameters.yaml</h2><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># //////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#                        SeisFlows YAML Parameter File</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># //////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Modules correspond to the structure of the source code, and determine</span></span><br><span class="line"><span class="comment"># SeisFlows' behavior at runtime. Each module requires its own sub-parameters.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># .. rubric::</span></span><br><span class="line"><span class="comment">#   - Determine available options for modules by running:</span></span><br><span class="line"><span class="comment">#       &gt; seisflows print modules</span></span><br><span class="line"><span class="comment">#   - Auto-fill with docstrings and default values (recommended) by running:</span></span><br><span class="line"><span class="comment">#       &gt; seisflows configure</span></span><br><span class="line"><span class="comment">#   - Swap out module parameters for a configured parameter file by running:</span></span><br><span class="line"><span class="comment">#       &gt; seisflows swap {module} {name} (e.g., seisflows swap solver specfem3d)</span></span><br><span class="line"><span class="comment">#   - To set values as NoneType, use: null</span></span><br><span class="line"><span class="comment">#   - To set values as infinity, use: inf</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#                                    MODULES</span></span><br><span class="line"><span class="comment">#                                    ///////</span></span><br><span class="line"><span class="comment"># workflow (str):    The types and order of functions for running SeisFlows</span></span><br><span class="line"><span class="comment"># system (str):      Computer architecture of the system being used</span></span><br><span class="line"><span class="comment"># solver (str):      External numerical solver to use for waveform simulations</span></span><br><span class="line"><span class="comment"># preprocess (str):  Preprocessing schema for waveform data</span></span><br><span class="line"><span class="comment"># optimize (str):    Optimization algorithm for the inverse problem</span></span><br><span class="line"><span class="comment"># ==============================================================================</span></span><br><span class="line"><span class="attr">workflow:</span> <span class="string">inversion</span></span><br><span class="line"><span class="attr">system:</span> <span class="string">workstation</span></span><br><span class="line"><span class="attr">solver:</span> <span class="string">specfem2d</span></span><br><span class="line"><span class="attr">preprocess:</span> <span class="string">pyaflowa</span></span><br><span class="line"><span class="attr">optimize:</span> <span class="string">LBFGS</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Forward Workflow</span></span><br><span class="line"><span class="comment">#    ----------------</span></span><br><span class="line"><span class="comment">#    Defines foundational structure for Workflow module. When used standalone </span></span><br><span class="line"><span class="comment">#    is in charge of running forward solver in parallel and (optionally) </span></span><br><span class="line"><span class="comment">#    calculating data-synthetic misfit and adjoint sources.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type modules: list of module</span></span><br><span class="line"><span class="comment">#    :param modules: instantiated SeisFlows modules which should have been</span></span><br><span class="line"><span class="comment">#        generated by the function `seisflows.config.import_seisflows` with a</span></span><br><span class="line"><span class="comment">#        parameter file generated by seisflows.configure</span></span><br><span class="line"><span class="comment">#    :type data_case: str</span></span><br><span class="line"><span class="comment">#    :param data_case: How to address 'data' in the workflow, available options:</span></span><br><span class="line"><span class="comment">#        'data': real data will be provided by the user in</span></span><br><span class="line"><span class="comment">#        `path_data/{source_name}` in the same format that the solver will</span></span><br><span class="line"><span class="comment">#        produce synthetics (controlled by `solver.format`) OR</span></span><br><span class="line"><span class="comment">#        synthetic': 'data' will be generated as synthetic seismograms using</span></span><br><span class="line"><span class="comment">#        a target model provided in `path_model_true`. If None, workflow will</span></span><br><span class="line"><span class="comment">#        not attempt to generate data.</span></span><br><span class="line"><span class="comment">#    :type stop_after: str</span></span><br><span class="line"><span class="comment">#    :param stop_after: optional name of task in task list (use</span></span><br><span class="line"><span class="comment">#        `seisflows print tasks` to get task list for given workflow) to stop</span></span><br><span class="line"><span class="comment">#        workflow after, allowing user to prematurely stop a workflow to explore</span></span><br><span class="line"><span class="comment">#        intermediate results or debug.</span></span><br><span class="line"><span class="comment">#    :type export_traces: bool</span></span><br><span class="line"><span class="comment">#    :param export_traces: export all waveforms that are generated by the</span></span><br><span class="line"><span class="comment">#        external solver to `path_output`. If False, solver traces stored in</span></span><br><span class="line"><span class="comment">#        scratch may be discarded at any time in the workflow</span></span><br><span class="line"><span class="comment">#    :type export_residuals: bool</span></span><br><span class="line"><span class="comment">#    :param export_residuals: export all residuals (data-synthetic misfit) that</span></span><br><span class="line"><span class="comment">#        are generated by the external solver to `path_output`. If False,</span></span><br><span class="line"><span class="comment">#        residuals stored in scratch may be discarded at any time in the </span></span><br><span class="line"><span class="comment">#        workflow</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    Migration Workflow</span></span><br><span class="line"><span class="comment">#    ------------------</span></span><br><span class="line"><span class="comment">#    Run forward and adjoint solver to produce event-dependent misfit kernels.</span></span><br><span class="line"><span class="comment">#    Sum and postprocess kernels to produce gradient. In seismic exploration</span></span><br><span class="line"><span class="comment">#    this is 'reverse time migration'.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type export_gradient: bool</span></span><br><span class="line"><span class="comment">#    :param export_gradient: export the gradient after it has been generated</span></span><br><span class="line"><span class="comment">#        in the scratch directory. If False, gradient can be discarded from</span></span><br><span class="line"><span class="comment">#        scratch at any time in the workflow</span></span><br><span class="line"><span class="comment">#    :type export_kernels: bool</span></span><br><span class="line"><span class="comment">#    :param export_kernels: export each sources event kernels after they have</span></span><br><span class="line"><span class="comment">#        been generated in the scratch directory. If False, gradient can be</span></span><br><span class="line"><span class="comment">#        discarded from scratch at any time in the workflow</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    Inversion Workflow</span></span><br><span class="line"><span class="comment">#    ------------------</span></span><br><span class="line"><span class="comment">#    Peforms iterative nonlinear inversion using the machinery of the Forward</span></span><br><span class="line"><span class="comment">#    and Migration workflows, as well as a built-in optimization library.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type start: int</span></span><br><span class="line"><span class="comment">#    :param start: start inversion workflow at this iteration. 1 &lt;= start &lt;= inf</span></span><br><span class="line"><span class="comment">#    :type end: int</span></span><br><span class="line"><span class="comment">#    :param end: end inversion workflow at this iteration. start &lt;= end &lt;= inf</span></span><br><span class="line"><span class="comment">#    :type iteration: int</span></span><br><span class="line"><span class="comment">#    :param iteration: The current iteration of the workflow. If NoneType, takes</span></span><br><span class="line"><span class="comment">#        the value of `start` (i.e., first iteration of the workflow). User can</span></span><br><span class="line"><span class="comment">#        also set between `start` and `end` to resume a failed workflow.</span></span><br><span class="line"><span class="comment">#    :type thrifty: bool</span></span><br><span class="line"><span class="comment">#    :param thrifty: a thrifty inversion skips the costly intialization step</span></span><br><span class="line"><span class="comment">#        (i.e., forward simulations and misfit quantification) if the final</span></span><br><span class="line"><span class="comment">#        forward simulations from the previous iterations line search can be</span></span><br><span class="line"><span class="comment">#        used in the current one. Requires L-BFGS optimization.</span></span><br><span class="line"><span class="comment">#    :type export_model: bool</span></span><br><span class="line"><span class="comment">#    :param export_model: export best-fitting model from the line search to disk.</span></span><br><span class="line"><span class="comment">#        If False, new models can be discarded from scratch at any time.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">data_case:</span> <span class="string">synthetic</span></span><br><span class="line"><span class="attr">stop_after:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">export_traces:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">export_residuals:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">export_gradient:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">export_kernels:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">start:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">end:</span> <span class="number">30</span></span><br><span class="line"><span class="attr">export_model:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">thrifty:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">iteration:</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Workstation System</span></span><br><span class="line"><span class="comment">#    ------------------</span></span><br><span class="line"><span class="comment">#    Defines foundational structure for System module. When used standalone,</span></span><br><span class="line"><span class="comment">#    runs solver tasks either in serial (if `nproc`==1; i.e., without MPI) or in</span></span><br><span class="line"><span class="comment">#    parallel (if `nproc`&gt;1; i.e., with MPI). All other tasks are run in serial.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type ntask: int</span></span><br><span class="line"><span class="comment">#    :param ntask: number of individual tasks/events to run during workflow.</span></span><br><span class="line"><span class="comment">#        Must be &lt;= the number of source files in `path_specfem_data`</span></span><br><span class="line"><span class="comment">#    :type nproc: int</span></span><br><span class="line"><span class="comment">#    :param nproc: number of processors to use for each simulation. Choose 1 for</span></span><br><span class="line"><span class="comment">#        serial simulations, and `nproc`&gt;1 for parallel simulations.</span></span><br><span class="line"><span class="comment">#    :type mpiexec: str</span></span><br><span class="line"><span class="comment">#    :param mpiexec: MPI executable on system. Defaults to 'mpirun -n ${NPROC}'</span></span><br><span class="line"><span class="comment">#    :type log_level: str</span></span><br><span class="line"><span class="comment">#    :param log_level: logger level to pass to logging module.</span></span><br><span class="line"><span class="comment">#        Available: 'debug', 'info', 'warning', 'critical'</span></span><br><span class="line"><span class="comment">#    :type verbose: bool</span></span><br><span class="line"><span class="comment">#    :param verbose: if True, formats the log messages to include the file</span></span><br><span class="line"><span class="comment">#        name, line number and message type. Useful for debugging but</span></span><br><span class="line"><span class="comment">#        also very verbose.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">ntask:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">nproc:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">mpiexec:</span> <span class="string">mpirun</span></span><br><span class="line"><span class="attr">log_level:</span> <span class="string">DEBUG</span></span><br><span class="line"><span class="attr">verbose:</span> <span class="literal">False</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Solver SPECFEM</span></span><br><span class="line"><span class="comment">#    --------------</span></span><br><span class="line"><span class="comment">#    Defines foundational structure for Specfem-based solver module. </span></span><br><span class="line"><span class="comment">#    Generalized SPECFEM interface to manipulate SPECFEM2D/3D/3D_GLOBE w/ Python</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type data_format: str</span></span><br><span class="line"><span class="comment">#    :param data_format: data format for reading traces into memory.</span></span><br><span class="line"><span class="comment">#        Available: ['SU': seismic unix format, 'ASCII': human-readable ascii]</span></span><br><span class="line"><span class="comment">#    :type materials: str</span></span><br><span class="line"><span class="comment">#    :param materials: Material parameters used to define model. Available:</span></span><br><span class="line"><span class="comment">#        ['ELASTIC': Vp, Vs, 'ACOUSTIC': Vp, 'ISOTROPIC', 'ANISOTROPIC']</span></span><br><span class="line"><span class="comment">#    :type density: bool</span></span><br><span class="line"><span class="comment">#    :param density: How to treat density during inversion. If True, updates</span></span><br><span class="line"><span class="comment">#        density during inversion. If False, keeps it constant.</span></span><br><span class="line"><span class="comment">#        TODO allow density scaling during an inversion</span></span><br><span class="line"><span class="comment">#    :type attenuation: bool</span></span><br><span class="line"><span class="comment">#    :param attenuation: How to treat attenuation during inversion.</span></span><br><span class="line"><span class="comment">#        if True, turns on attenuation during forward simulations only. If</span></span><br><span class="line"><span class="comment">#        False, attenuation is always set to False. Requires underlying</span></span><br><span class="line"><span class="comment">#        attenution (Q_mu, Q_kappa) model</span></span><br><span class="line"><span class="comment">#    :type smooth_h: float</span></span><br><span class="line"><span class="comment">#    :param smooth_h: Gaussian half-width for horizontal smoothing in units</span></span><br><span class="line"><span class="comment">#        of meters. If 0., no smoothing applied. Only applicable for workflows:</span></span><br><span class="line"><span class="comment">#        ['migration', 'inversion'], ignored for 'forward' workflow.</span></span><br><span class="line"><span class="comment">#    :type smooth_h: float</span></span><br><span class="line"><span class="comment">#    :param smooth_v: Gaussian half-width for vertical smoothing in units</span></span><br><span class="line"><span class="comment">#        of meters. Only applicable for workflows: ['migration', 'inversion'],</span></span><br><span class="line"><span class="comment">#        ignored for 'forward' workflow.</span></span><br><span class="line"><span class="comment">#    :type components: str</span></span><br><span class="line"><span class="comment">#    :param components: components to consider and tag data with. Should be</span></span><br><span class="line"><span class="comment">#        string of letters such as 'RTZ'</span></span><br><span class="line"><span class="comment">#    :type solver_io: str</span></span><br><span class="line"><span class="comment">#    :param solver_io: format of model/kernel/gradient files expected by the</span></span><br><span class="line"><span class="comment">#        numerical solver. Available: ['fortran_binary': default .bin files].</span></span><br><span class="line"><span class="comment">#        <span class="doctag">TODO:</span> ['adios': ADIOS formatted files]</span></span><br><span class="line"><span class="comment">#    :type source_prefix: str</span></span><br><span class="line"><span class="comment">#    :param source_prefix: prefix of source/event/earthquake files. If None,</span></span><br><span class="line"><span class="comment">#        will attempt to guess based on the specific solver chosen.</span></span><br><span class="line"><span class="comment">#    :type mpiexec: str</span></span><br><span class="line"><span class="comment">#    :param mpiexec: MPI executable used to run parallel processes. Should also</span></span><br><span class="line"><span class="comment">#        be defined for the system module</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    Solver SPECFEM2D</span></span><br><span class="line"><span class="comment">#    ----------------</span></span><br><span class="line"><span class="comment">#    SPECFEM2D-specific alterations to the base SPECFEM module</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type source_prefix: str</span></span><br><span class="line"><span class="comment">#    :param source_prefix: Prefix of source files in path SPECFEM_DATA. Defaults</span></span><br><span class="line"><span class="comment">#        to 'SOURCE'</span></span><br><span class="line"><span class="comment">#    :type multiples: bool</span></span><br><span class="line"><span class="comment">#    :param multiples: set an absorbing top-boundary condition</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">data_format:</span> <span class="string">ascii</span></span><br><span class="line"><span class="attr">materials:</span> <span class="string">elastic</span></span><br><span class="line"><span class="attr">density:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">attenuation:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">smooth_h:</span> <span class="number">40000.0</span></span><br><span class="line"><span class="attr">smooth_v:</span> <span class="number">40000.0</span></span><br><span class="line"><span class="attr">components:</span> <span class="string">XZ</span></span><br><span class="line"><span class="attr">source_prefix:</span> <span class="string">SOURCE</span></span><br><span class="line"><span class="attr">multiples:</span> <span class="literal">False</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Pyaflowa Preprocess</span></span><br><span class="line"><span class="comment">#    -------------------</span></span><br><span class="line"><span class="comment">#    Preprocessing and misfit quantification using Python's Adjoint Tomography</span></span><br><span class="line"><span class="comment">#    Operations Assistance (Pyatoa)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type min_period: float</span></span><br><span class="line"><span class="comment">#    :param min_period: Minimum filter corner in unit seconds. Bandpass</span></span><br><span class="line"><span class="comment">#    filter if set with `max_period`, highpass filter if set without</span></span><br><span class="line"><span class="comment">#    `max_period`, no filtering if not set and `max_period also not set</span></span><br><span class="line"><span class="comment">#    :type max_period: float</span></span><br><span class="line"><span class="comment">#    :param max_period: Maximum filter corner in unit seconds. Bandpass</span></span><br><span class="line"><span class="comment">#        filter if set with `min_period`, lowpass filter if set without</span></span><br><span class="line"><span class="comment">#        `min_period`, no filtering if not set and `min_period also not set</span></span><br><span class="line"><span class="comment">#   :type filter_corners: int</span></span><br><span class="line"><span class="comment">#    :param filter_corners: number of filter corners applied to filtering</span></span><br><span class="line"><span class="comment">#    :type client: str</span></span><br><span class="line"><span class="comment">#    :param client: Client name for ObsPy FDSN data gathering. Pyatoa will</span></span><br><span class="line"><span class="comment">#        attempt to collect waveform and metadata based on network and</span></span><br><span class="line"><span class="comment">#        station codes provided in the SPECFEM STATIONS file. If set None,</span></span><br><span class="line"><span class="comment">#        no FDSN gathering will be attempted</span></span><br><span class="line"><span class="comment">#    :type rotate: bool</span></span><br><span class="line"><span class="comment">#    :param rotate: Attempt to rotate waveform components from NEZ -&gt; RTZ</span></span><br><span class="line"><span class="comment">#    :type pyflex_preset: str</span></span><br><span class="line"><span class="comment">#    :param pyflex_preset: Parameter map for misfit window configuration</span></span><br><span class="line"><span class="comment">#        defined by Pyflex. IF None, misfit and adjoint sources will be</span></span><br><span class="line"><span class="comment">#        calculated on whole traces. For available choices, see Pyatoa docs</span></span><br><span class="line"><span class="comment">#        page (pyatoa.rtfd.io)</span></span><br><span class="line"><span class="comment">#    :type fix_windows: bool or str</span></span><br><span class="line"><span class="comment">#    :param fix_windows: How to address misfit window evaluation at each</span></span><br><span class="line"><span class="comment">#        evaluation. Options to re-use misfit windows collected during an</span></span><br><span class="line"><span class="comment">#        inversion, available options:</span></span><br><span class="line"><span class="comment">#        [True, False, 'ITER', 'ONCE']</span></span><br><span class="line"><span class="comment">#        True: Re-use windows after first evaluation (i01s00);</span></span><br><span class="line"><span class="comment">#        False: Calculate new windows each evaluation;</span></span><br><span class="line"><span class="comment">#        'ITER': Calculate new windows at first evaluation of</span></span><br><span class="line"><span class="comment">#        each iteration (e.g., i01s00... i02s00...</span></span><br><span class="line"><span class="comment">#        'ONCE': Calculate new windows at first evaluation of</span></span><br><span class="line"><span class="comment">#        the workflow, i.e., at self.par.BEGIN</span></span><br><span class="line"><span class="comment">#    :type adj_src_type: str</span></span><br><span class="line"><span class="comment">#    :param adj_src_type: Adjoint source type to evaluate misfit, defined by</span></span><br><span class="line"><span class="comment">#        Pyadjoint. Currently available options: ['cc': cross-correlation,</span></span><br><span class="line"><span class="comment">#        'mt': multitaper, 'wav': waveform']</span></span><br><span class="line"><span class="comment">#    :type plot: bool</span></span><br><span class="line"><span class="comment">#    :param plot: plot waveform figures and source receiver maps during</span></span><br><span class="line"><span class="comment">#        the preprocessing stage</span></span><br><span class="line"><span class="comment">#    :type pyatoa_log_level: str</span></span><br><span class="line"><span class="comment">#    :param pyatoa_log_level: Log level to set Pyatoa, Pyflex, Pyadjoint.</span></span><br><span class="line"><span class="comment">#        Available: ['null': no logging, 'warning': warnings only,</span></span><br><span class="line"><span class="comment">#        'info': task tracking, 'debug': log all small details (recommended)]</span></span><br><span class="line"><span class="comment">#    :type unit_output: str</span></span><br><span class="line"><span class="comment">#    :param unit_output: Data units. Must match the synthetic output of</span></span><br><span class="line"><span class="comment">#        external solver. Available: ['DISP': displacement, 'VEL': velocity,</span></span><br><span class="line"><span class="comment">#        'ACC': acceleration]</span></span><br><span class="line"><span class="comment">#    :type export_datasets: bool</span></span><br><span class="line"><span class="comment">#    :param export_datasets: periodically save the output ASDFDataSets which</span></span><br><span class="line"><span class="comment">#        contain data, metadata and results collected during the</span></span><br><span class="line"><span class="comment">#        preprocessing procedure</span></span><br><span class="line"><span class="comment">#    :type export_figures: bool</span></span><br><span class="line"><span class="comment">#    :param export_figures: periodically save the output basemaps and</span></span><br><span class="line"><span class="comment">#        data-synthetic waveform comparison figures</span></span><br><span class="line"><span class="comment">#    :type export_log_files: bool</span></span><br><span class="line"><span class="comment">#    :param export_log_files: periodically save log files created by Pyatoa</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">min_period:</span> <span class="number">10.0</span></span><br><span class="line"><span class="attr">max_period:</span> <span class="number">200.0</span></span><br><span class="line"><span class="attr">filter_corners:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">client:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">rotate:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">pyflex_preset:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">fix_windows:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">adj_src_type:</span> <span class="string">waveform</span></span><br><span class="line"><span class="attr">plot:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">pyatoa_log_level:</span> <span class="string">DEBUG</span></span><br><span class="line"><span class="attr">unit_output:</span> <span class="string">DISP</span></span><br><span class="line"><span class="attr">max_workers:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">export_datasets:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">export_figures:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">export_log_files:</span> <span class="literal">True</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Gradient Optimization</span></span><br><span class="line"><span class="comment">#    ---------------------</span></span><br><span class="line"><span class="comment">#    Defines foundational structure for Optimization module. Applies a </span></span><br><span class="line"><span class="comment">#    gradient/steepest descent optimization algorithm.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type line_search_method: str</span></span><br><span class="line"><span class="comment">#    :param line_search_method: chosen line_search algorithm. Currently available</span></span><br><span class="line"><span class="comment">#        are 'bracket' and 'backtrack'. See seisflows.plugins.line_search</span></span><br><span class="line"><span class="comment">#        for all available options</span></span><br><span class="line"><span class="comment">#    :type preconditioner: str</span></span><br><span class="line"><span class="comment">#    :param preconditioner: algorithm for preconditioning gradients. Currently</span></span><br><span class="line"><span class="comment">#        available: 'diagonal'. Requires `path_preconditioner` to point to a</span></span><br><span class="line"><span class="comment">#        set of files that define the preconditioner, formatted the same as the</span></span><br><span class="line"><span class="comment">#        input model</span></span><br><span class="line"><span class="comment">#    :type step_count_max: int</span></span><br><span class="line"><span class="comment">#    :param step_count_max: maximum number of trial steps to perform during</span></span><br><span class="line"><span class="comment">#        the line search before a change in line search behavior is</span></span><br><span class="line"><span class="comment">#        considered, or a line search is considered to have failed.</span></span><br><span class="line"><span class="comment">#    :type step_len_init: float</span></span><br><span class="line"><span class="comment">#    :param step_len_init: initial line search step length guess, provided</span></span><br><span class="line"><span class="comment">#        as a fraction of current model parameters.</span></span><br><span class="line"><span class="comment">#    :type step_len_max: float</span></span><br><span class="line"><span class="comment">#    :param step_len_max: maximum allowable step length during the line</span></span><br><span class="line"><span class="comment">#        search. Set as a fraction of the current model parameters</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    L-BFGS Optimization</span></span><br><span class="line"><span class="comment">#    -------------------</span></span><br><span class="line"><span class="comment">#    Limited memory BFGS nonlienar optimization algorithm</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    Parameters</span></span><br><span class="line"><span class="comment">#    ----------</span></span><br><span class="line"><span class="comment">#    :type lbfgs_mem: int</span></span><br><span class="line"><span class="comment">#    :param lbfgs_mem: L-BFGS memory. Max number of previous gradients to</span></span><br><span class="line"><span class="comment">#        retain in local memory for approximating the objective function.</span></span><br><span class="line"><span class="comment">#    :type lbfgs_max: L-BFGS periodic restart interval. Must be</span></span><br><span class="line"><span class="comment">#        1 &lt;= lbfgs_max &lt;= infinity.</span></span><br><span class="line"><span class="comment">#    :type lbfgs_thresh: L-BFGS angle restart threshold. If the angle between</span></span><br><span class="line"><span class="comment">#        the current and previous search direction exceeds this value,</span></span><br><span class="line"><span class="comment">#        optimization algorithm will be restarted.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">preconditioner:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">step_count_max:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">step_len_init:</span> <span class="number">0.05</span></span><br><span class="line"><span class="attr">step_len_max:</span> <span class="number">0.5</span></span><br><span class="line"><span class="attr">line_search_method:</span> <span class="string">Backtrack</span></span><br><span class="line"><span class="attr">LBFGS_mem:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">LBFGS_max:</span> <span class="string">inf</span></span><br><span class="line"><span class="attr">LBFGS_thresh:</span> <span class="number">0.0</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#	 Paths</span></span><br><span class="line"><span class="comment">#	 -----</span></span><br><span class="line"><span class="comment">#    :type workdir: str</span></span><br><span class="line"><span class="comment">#    :param workdir: working directory in which to perform a SeisFlows workflow.</span></span><br><span class="line"><span class="comment">#        SeisFlows internal directory structure will be created here. Default cwd</span></span><br><span class="line"><span class="comment">#    :type path_output: str</span></span><br><span class="line"><span class="comment">#    :param path_output: path to directory used for permanent storage on disk.</span></span><br><span class="line"><span class="comment">#        Results and exported scratch files are saved here.</span></span><br><span class="line"><span class="comment">#    :type path_data: str</span></span><br><span class="line"><span class="comment">#    :param path_data: path to any externally stored data required by the solver</span></span><br><span class="line"><span class="comment">#    :type path_state_file: str</span></span><br><span class="line"><span class="comment">#    :param path_state_file: path to a text file used to track the current</span></span><br><span class="line"><span class="comment">#        status of a workflow (i.e., what functions have already been completed),</span></span><br><span class="line"><span class="comment">#        used for checkpointing and resuming workflows</span></span><br><span class="line"><span class="comment">#    :type path_model_init: str</span></span><br><span class="line"><span class="comment">#    :param path_model_init: path to the starting model used to calculate the</span></span><br><span class="line"><span class="comment">#        initial misfit. Must match the expected `solver_io` format.</span></span><br><span class="line"><span class="comment">#    :type path_model_true: str</span></span><br><span class="line"><span class="comment">#    :param path_model_true: path to a target model if `case`=='synthetic' and</span></span><br><span class="line"><span class="comment">#        a set of synthetic 'observations' are required for workflow.</span></span><br><span class="line"><span class="comment">#    :type path_eval_grad: str</span></span><br><span class="line"><span class="comment">#    :param path_eval_grad: scratch path to store files for gradient evaluation,</span></span><br><span class="line"><span class="comment">#        including models, kernels, gradient and residuals.</span></span><br><span class="line"><span class="comment">#        :type path_mask: str</span></span><br><span class="line"><span class="comment">#    :param path_mask: optional path to a masking function which is used to</span></span><br><span class="line"><span class="comment">#        mask out or scale parts of the gradient. The user-defined mask must</span></span><br><span class="line"><span class="comment">#        match the file format of the input model (e.g., .bin files).</span></span><br><span class="line"><span class="comment">#        :type path_eval_func: str</span></span><br><span class="line"><span class="comment">#    :param path_eval_func: scratch path to store files for line search objective</span></span><br><span class="line"><span class="comment">#        function evaluations, including models, misfit and residuals</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    :type path_output_log: str</span></span><br><span class="line"><span class="comment">#    :param path_output_log: path to a text file used to store the outputs of</span></span><br><span class="line"><span class="comment">#        the package wide logger, which are also written to stdout</span></span><br><span class="line"><span class="comment">#    :type path_par_file: str</span></span><br><span class="line"><span class="comment">#    :param path_par_file: path to parameter file which is used to instantiate</span></span><br><span class="line"><span class="comment">#        the package</span></span><br><span class="line"><span class="comment">#    :type path_log_files: str</span></span><br><span class="line"><span class="comment">#    :param path_log_files: path to a directory where individual log files are</span></span><br><span class="line"><span class="comment">#        saved whenever a number of parallel tasks are run on the system.</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    :type path_data: str</span></span><br><span class="line"><span class="comment">#    :param path_data: path to any externally stored data required by the solver</span></span><br><span class="line"><span class="comment">#    :type path_specfem_bin: str</span></span><br><span class="line"><span class="comment">#    :param path_specfem_bin: path to SPECFEM bin/ directory which</span></span><br><span class="line"><span class="comment">#        contains binary executables for running SPECFEM</span></span><br><span class="line"><span class="comment">#    :type path_specfem_data: str</span></span><br><span class="line"><span class="comment">#    :param path_specfem_data: path to SPECFEM DATA/ directory which must</span></span><br><span class="line"><span class="comment">#        contain the CMTSOLUTION, STATIONS and Par_file files used for</span></span><br><span class="line"><span class="comment">#        running SPECFEM</span></span><br><span class="line"><span class="comment">#            </span></span><br><span class="line"><span class="comment">#    :type path_preprocess: str</span></span><br><span class="line"><span class="comment">#    :param path_preprocess: scratch path for preprocessing related steps</span></span><br><span class="line"><span class="comment">#        </span></span><br><span class="line"><span class="comment">#    :type path_preconditioner: str</span></span><br><span class="line"><span class="comment">#    :param path_preconditioner: optional path to a set of preconditioner files</span></span><br><span class="line"><span class="comment">#        formatted the same as the input model (or output model of solver).</span></span><br><span class="line"><span class="comment">#        Required to exist and contain files if `preconditioner`==True</span></span><br><span class="line"><span class="comment">#            </span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="attr">path_workdir:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/4</span></span><br><span class="line"><span class="attr">path_scratch:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/scratch</span></span><br><span class="line"><span class="attr">path_eval_grad:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/scratch/eval_grad</span></span><br><span class="line"><span class="attr">path_output:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/output</span></span><br><span class="line"><span class="attr">path_model_init:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/specfem2d_workdir/OUTPUT_FILES_INIT</span></span><br><span class="line"><span class="attr">path_model_true:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/specfem2d_workdir/OUTPUT_FILES_TRUE</span></span><br><span class="line"><span class="attr">path_state_file:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/sfstate.txt</span></span><br><span class="line"><span class="attr">path_data:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">path_mask:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">path_eval_func:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/scratch/eval_func</span></span><br><span class="line"><span class="attr">path_par_file:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/parameters.yaml</span></span><br><span class="line"><span class="attr">path_log_files:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/logs</span></span><br><span class="line"><span class="attr">path_output_log:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/sflog.txt</span></span><br><span class="line"><span class="attr">path_specfem_bin:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/specfem2d/bin</span></span><br><span class="line"><span class="attr">path_specfem_data:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/specfem2d_workdir/DATA</span></span><br><span class="line"><span class="attr">path_solver:</span> <span class="string">/home/erbiaoger/MyProjects/Seisflows/work/day_3/44/scratch/solver</span></span><br><span class="line"><span class="attr">path_preconditioner:</span> <span class="literal">null</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="Par-file"><a href="#Par-file" class="headerlink" title="Par_file"></a>Par_file</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Simulation input parameters</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">title of job</span></span><br><span class="line">title                           = Tape-Liu-Tromp (GJI 2007)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">forward or adjoint simulation</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1 = forward, 2 = adjoint, 3 = both simultaneously</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">note: 2 is purposely UNUSED (<span class="keyword">for</span> compatibility with the numbering of our 3D codes)</span></span><br><span class="line">SIMULATION_TYPE                 = 1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0 = regular wave propagation simulation, 1/2/3 = noise simulation</span></span><br><span class="line">NOISE_TOMOGRAPHY                = 0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">save the last frame, needed <span class="keyword">for</span> adjoint simulation</span></span><br><span class="line">SAVE_FORWARD                    = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">parameters concerning partitioning</span></span><br><span class="line">NPROC                           = 4              # number of processes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">time step parameters</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">total number of time steps</span></span><br><span class="line">NSTEP                           = 14000</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">duration of a time step (see section <span class="string">"How to choose the time step"</span> of the manual <span class="keyword">for</span> how to <span class="keyword">do</span> this)</span></span><br><span class="line">DT                              = 2.5d-2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">time stepping</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1 = Newmark (2nd order), 2 = LDDRK4-6 (4th-order 6-stage low storage Runge-Kutta), 3 = classical RK4 4th-order 4-stage Runge-Kutta</span></span><br><span class="line">time_stepping_scheme            = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> the <span class="built_in">type</span> of calculation (P-SV or SH/membrane waves)</span></span><br><span class="line">P_SV                            = .true.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">axisymmetric (2.5D) or Cartesian planar (2D) simulation</span></span><br><span class="line">AXISYM                          = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Mesh</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Partitioning algorithm <span class="keyword">for</span> decompose_mesh</span></span><br><span class="line">PARTITIONING_TYPE               = 3              # SCOTCH = 3, ascending order (very bad idea) = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">number of control nodes per element (4 or 9)</span></span><br><span class="line">NGNOD                           = 4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">creates/reads a binary database that allows to skip all time consuming setup steps <span class="keyword">in</span> initialization</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0 = does not <span class="built_in">read</span>/create database</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1 = creates database</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2 = reads database</span></span><br><span class="line">setup_with_binary_database      = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">available models</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  default       - define model using nbmodels below</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  ascii         - <span class="built_in">read</span> model from ascii database file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  binary        - <span class="built_in">read</span> model from binary databse file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  binary_voigt  - <span class="built_in">read</span> Voigt model from binary database file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  external      - define model using define_external_model subroutine</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  gll           - <span class="built_in">read</span> GLL model from binary database file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  legacy        - <span class="built_in">read</span> model from model_velocity.dat_input</span></span><br><span class="line">MODEL                           = gll</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Output the model with the requested <span class="built_in">type</span>, does not save <span class="keyword">if</span> turn to default or .<span class="literal">false</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(available output formats: ascii,binary,gll,legacy)</span></span><br><span class="line">SAVE_MODEL                      = binary</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Attenuation</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">attenuation parameters</span></span><br><span class="line">ATTENUATION_VISCOELASTIC        = .false.        # turn attenuation (viscoelasticity) on or off for non-poroelastic solid parts of the model</span><br><span class="line">ATTENUATION_VISCOACOUSTIC       = .false.        # turn attenuation (viscoacousticity) on or off for non-poroelastic fluid parts of the model</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> viscoelastic or viscoacoustic attenuation</span></span><br><span class="line">N_SLS                           = 3              # number of standard linear solids for attenuation (3 is usually the minimum)</span><br><span class="line">ATTENUATION_f0_REFERENCE        = 5.196152422706633 # in case of attenuation, reference frequency in Hz at which the velocity values in the velocity model are given (unused otherwise); relevant only if source is a Dirac or a Heaviside, otherwise it is automatically set to f0 the dominant frequency of the source in the DATA/SOURCE file</span><br><span class="line">READ_VELOCITIES_AT_f0           = .false.        # read seismic velocities at ATTENUATION_f0_REFERENCE instead of at infinite frequency (see user manual for more information)</span><br><span class="line">USE_SOLVOPT                     = .false.        # use more precise but much more expensive way of determining the Q factor relaxation times, as in https://doi.org/10.1093/gji/ggw024</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> poroelastic attenuation</span></span><br><span class="line">ATTENUATION_PORO_FLUID_PART     = .false.        # turn viscous attenuation on or off for the fluid part of poroelastic parts of the model</span><br><span class="line">Q0_poroelastic                  = 1              # quality factor for viscous attenuation (ignore it if you are not using a poroelastic material)</span><br><span class="line">freq0_poroelastic               = 10             # frequency for viscous attenuation (ignore it if you are not using a poroelastic material)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to undo attenuation and/or PMLs <span class="keyword">for</span> sensitivity kernel calculations or forward runs with SAVE_FORWARD</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use the flag below. It performs undoing of attenuation and/or of PMLs <span class="keyword">in</span> an exact way <span class="keyword">for</span> sensitivity kernel calculations</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">but requires disk space <span class="keyword">for</span> temporary storage, and uses a significant amount of memory used as buffers <span class="keyword">for</span> temporary storage.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">When that option is on the second parameter indicates how often the code dumps restart files to disk (<span class="keyword">if</span> <span class="keyword">in</span> doubt, use something between 100 and 1000).</span></span><br><span class="line">UNDO_ATTENUATION_AND_OR_PML     = .false.</span><br><span class="line">NT_DUMP_ATTENUATION             = 500</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Instead of reconstructing the forward wavefield, this option reads it from the disk using asynchronous I/O.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Outperforms conventional mode using a value of NTSTEP_BETWEEN_COMPUTE_KERNELS high enough.</span></span><br><span class="line">NO_BACKWARD_RECONSTRUCTION      = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Sources</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">source</span> parameters</span></span><br><span class="line">NSOURCES                        = 1              # number of sources (source information is then read from the DATA/SOURCE file)</span><br><span class="line">force_normal_to_surface         = .false.        # angleforce normal to surface (external mesh and curve file needed)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use an existing initial wave field as <span class="built_in">source</span> or start from zero (medium initially at rest)</span></span><br><span class="line">initialfield                    = .false.</span><br><span class="line">add_Bielak_conditions_bottom    = .false.        # add Bielak conditions or not if initial plane wave</span><br><span class="line">add_Bielak_conditions_right     = .false.</span><br><span class="line">add_Bielak_conditions_top       = .false.</span><br><span class="line">add_Bielak_conditions_left      = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">acoustic forcing</span></span><br><span class="line">ACOUSTIC_FORCING                = .false.        # acoustic forcing of an acoustic medium with a rigid interface</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">noise simulations - <span class="built_in">type</span> of noise <span class="built_in">source</span> time <span class="keyword">function</span>:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">0=external (S_squared), 1=Ricker(second derivative), 2=Ricker(first derivative), 3=Gaussian, 4=Figure 2a of Tromp et al. 2010</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(default value 4 is chosen to reproduce the time <span class="keyword">function</span> from Fig 2a of <span class="string">"Tromp et al., 2010, Noise Cross-Correlation Sensitivity Kernels"</span>)</span></span><br><span class="line">noise_source_time_function_type = 4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">moving sources</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set write_moving_sources_database to .<span class="literal">true</span>. <span class="keyword">if</span> the generation of moving <span class="built_in">source</span> databases takes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a long time. Then the simulation is <span class="keyword">done</span> <span class="keyword">in</span> two steps: first you run the code and it writes the databases to file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(<span class="keyword">in</span> DATA folder by default). Then you rerun the code and it will <span class="built_in">read</span> the databases <span class="keyword">in</span> there directly possibly</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">saving a lot of time.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This is only useful <span class="keyword">for</span> GPU version (<span class="keyword">for</span> now)</span></span><br><span class="line">write_moving_sources_database   = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Receivers</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">receiver <span class="built_in">set</span> parameters <span class="keyword">for</span> recording stations (i.e. recording points)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">seismotype : record 1=displ 2=veloc 3=accel 4=pressure 5=curl of displ 6=the fluid potential</span></span><br><span class="line">seismotype                      = 1              # several values can be chosen. For example : 1,2,4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">interval <span class="keyword">in</span> time steps <span class="keyword">for</span> writing of seismograms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">every how many time steps we save the seismograms</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(costly, <span class="keyword">do</span> not use a very small value; <span class="keyword">if</span> you use a very large value that is larger than the total number</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> of time steps of the run, the seismograms will automatically be saved once at the end of the run anyway)</span></span><br><span class="line">NTSTEP_BETWEEN_OUTPUT_SEISMOS   = 100</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> to n to reduce the sampling rate of output seismograms by a <span class="built_in">factor</span> of n</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">defaults to 1, <span class="built_in">which</span> means no down-sampling</span></span><br><span class="line">NTSTEP_BETWEEN_OUTPUT_SAMPLE    = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">so far, this option can only be used <span class="keyword">if</span> all the receivers are <span class="keyword">in</span> acoustic elements</span></span><br><span class="line">USE_TRICK_FOR_BETTER_PRESSURE   = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use this t0 as earliest starting time rather than the automatically calculated one</span></span><br><span class="line">USER_T0                         = 90.0d0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">seismogram formats</span></span><br><span class="line">save_ASCII_seismograms          = .true.         # save seismograms in ASCII format or not</span><br><span class="line">save_binary_seismograms_single  = .false.        # save seismograms in single precision binary format or not (can be used jointly with ASCII above to save both)</span><br><span class="line">save_binary_seismograms_double  = .false.        # save seismograms in double precision binary format or not (can be used jointly with both flags above to save all)</span><br><span class="line">SU_FORMAT                       = .false.        # output single precision binary seismograms in Seismic Unix format (adjoint traces will be read in the same format)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use an existing STATION file found <span class="keyword">in</span> ./DATA or create a new one from the receiver positions below <span class="keyword">in</span> this Par_file</span></span><br><span class="line">use_existing_STATIONS           = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">number of receiver sets (i.e. number of receiver lines to create below)</span></span><br><span class="line">nreceiversets                   = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">orientation</span></span><br><span class="line">anglerec                        = 0.d0           # angle to rotate components at receivers</span><br><span class="line">rec_normal_to_surface           = .false.        # base anglerec normal to surface (external mesh and curve file needed)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">first receiver <span class="built_in">set</span> (repeat these 6 lines and adjust nreceiversets accordingly)</span></span><br><span class="line">nrec                            = 40              # number of receivers</span><br><span class="line">xdeb                            = 10000.      # first receiver x in meters</span><br><span class="line">zdeb                            = 180000.      # first receiver z in meters</span><br><span class="line">xfin                            = 470000.        # last receiver x in meters (ignored if only one receiver)</span><br><span class="line">zfin                            = 180000.         # last receiver z in meters (ignored if only one receiver)</span><br><span class="line">record_at_surface_same_vertical = .true.        # receivers inside the medium or at the surface</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># adjoint kernel outputs</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">save sensitivity kernels <span class="keyword">in</span> ASCII format (much bigger files, but compatible with current GMT scripts) or <span class="keyword">in</span> binary format</span></span><br><span class="line">save_ASCII_kernels              = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">since the accuracy of kernel integration may not need to respect the CFL, this option permits to save computing time, and memory with UNDO_ATTENUATION_AND_OR_PML mode</span></span><br><span class="line">NTSTEP_BETWEEN_COMPUTE_KERNELS  = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">outputs approximate Hessian <span class="keyword">for</span> preconditioning</span></span><br><span class="line">APPROXIMATE_HESS_KL             = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Boundary conditions</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Perfectly Matched Layer (PML) boundaries</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">absorbing boundary active or not</span></span><br><span class="line">PML_BOUNDARY_CONDITIONS         = .false.</span><br><span class="line">NELEM_PML_THICKNESS             = 3</span><br><span class="line">ROTATE_PML_ACTIVATE             = .false.</span><br><span class="line">ROTATE_PML_ANGLE                = 30.</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">change the four parameters below only <span class="keyword">if</span> you know what you are doing; they change the damping profiles inside the PMLs</span></span><br><span class="line">K_MIN_PML                       = 1.0d0          # from Gedney page 8.11</span><br><span class="line">K_MAX_PML                       = 1.0d0</span><br><span class="line">damping_change_factor_acoustic  = 0.5d0</span><br><span class="line">damping_change_factor_elastic   = 1.0d0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> the parameter below to .<span class="literal">false</span>. unless you know what you are doing; this implements automatic adjustment of the PML parameters <span class="keyword">for</span> elongated models.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The goal is to improve the absorbing efficiency of PML <span class="keyword">for</span> waves with large incidence angles, but this can lead to artefacts.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">In particular, this option is efficient only when the number of sources NSOURCES is equal to one.</span></span><br><span class="line">PML_PARAMETER_ADJUSTMENT        = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Stacey ABC</span></span><br><span class="line">STACEY_ABSORBING_CONDITIONS     = .true.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">periodic boundaries</span></span><br><span class="line">ADD_PERIODIC_CONDITIONS         = .false.</span><br><span class="line">PERIODIC_HORIZ_DIST             = 0.3597d0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Velocity and density models</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">number of model materials</span></span><br><span class="line">nbmodels                        = 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">available material types (see user manual <span class="keyword">for</span> more information)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  acoustic:              model_number 1 rho Vp 0  0 0 QKappa 9999 0 0 0 0 0 0 (<span class="keyword">for</span> QKappa use 9999 to ignore it)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  elastic:               model_number 1 rho Vp Vs 0 0 QKappa Qmu  0 0 0 0 0 0 (<span class="keyword">for</span> QKappa and Qmu use 9999 to ignore them)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  anisotropic:           model_number 2 rho c11 c13 c15 c33 c35 c55 c12 c23 c25   0 QKappa Qmu</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  anisotropic <span class="keyword">in</span> AXISYM: model_number 2 rho c11 c13 c15 c33 c35 c55 c12 c23 c25 c22 QKappa Qmu</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  poroelastic:           model_number 3 rhos rhof phi c kxx kxz kzz Ks Kf Kfr etaf mufr Qmu</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  tomo:                  model_number -1 0 0 A 0 0 0 0 0 0 0 0 0 0</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># note: When viscoelasticity or viscoacousticity is turned on,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      the Vp and Vs values that are <span class="built_in">read</span> here are the UNRELAXED ones i.e. the values at infinite frequency</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      unless the READ_VELOCITIES_AT_f0 parameter above is <span class="built_in">set</span> to <span class="literal">true</span>, <span class="keyword">in</span> <span class="built_in">which</span> <span class="keyword">case</span> they are the values at frequency f0.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#       Please also note that Qmu is always equal to Qs, but Qkappa is in general not equal to Qp.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      To convert one to the other see doc/Qkappa_Qmu_versus_Qp_Qs_relationship_in_2D_plane_strain.pdf and</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      utils/attenuation/conversion_from_Qkappa_Qmu_to_Qp_Qs_from_Dahlen_Tromp_959_960.f90.</span></span><br><span class="line">1 1 2600.d0 5800.d0 3500.0d0 0 0 10.d0 10.d0 0 0 0 0 0 0</span><br><span class="line">2 1 2600.d0 5800.d0 3500.0d0 0 0 10.d0 10.d0 0 0 0 0 0 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1 1 2600.d0 5600.d0 3200.0d0 0 0 10.d0 10.d0 0 0 0 0 0 0</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2 1 2600.d0 6000.d0 3800.0d0 0 0 10.d0 10.d0 0 0 0 0 0 0</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">external tomography file</span></span><br><span class="line">TOMOGRAPHY_FILE                 = ./DATA/tomo_file.xyz</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use an external mesh created by an external meshing tool or use the internal mesher</span></span><br><span class="line">read_external_mesh              = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># PARAMETERS FOR EXTERNAL MESHING</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">data concerning mesh, when generated using third-party app (more info <span class="keyword">in</span> README)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(see also absorbing_conditions above)</span></span><br><span class="line">mesh_file                       = ./DATA/ice_water_rock_1D/ice_water_rock_1D_elements   # file containing the mesh</span><br><span class="line">nodes_coords_file               = ./DATA/ice_water_rock_1D/ice_water_rock_1D_nodes   # file containing the nodes coordinates</span><br><span class="line">materials_file                  = ./DATA/ice_water_rock_1D/ice_water_rock_1D_material   # file containing the material number for each element</span><br><span class="line">free_surface_file               = ./DATA/ice_water_rock_1D/ice_water_rock_1D_surface_free   # file containing the free surface</span><br><span class="line">axial_elements_file             = ./DATA/axial_elements_file   # file containing the axial elements if AXISYM is true</span><br><span class="line">absorbing_surface_file          = ./DATA/ice_water_rock_1D/ice_water_rock_1D_surface_absorb   # file containing the absorbing surface</span><br><span class="line">acoustic_forcing_surface_file   = ./DATA/MSH/Surf_acforcing_Bottom_enforcing_mesh   # file containing the acoustic forcing surface</span><br><span class="line">absorbing_cpml_file             = ./DATA/absorbing_cpml_file   # file containing the CPML element numbers</span><br><span class="line">tangential_detection_curve_file = ./DATA/courbe_eros_nodes  # file containing the curve delimiting the velocity model</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># PARAMETERS FOR INTERNAL MESHING</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">file containing interfaces <span class="keyword">for</span> internal mesh</span></span><br><span class="line">interfacesfile                  = interfaces_Tape2007.dat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">geometry of the model (origin lower-left corner = 0,0) and mesh description</span></span><br><span class="line">xmin                            = 0.d0           # abscissa of left side of the model</span><br><span class="line">xmax                            = 480000.d0      # abscissa of right side of the model</span><br><span class="line">nx                              = 40             # number of elements along X</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">absorbing boundary parameters (see absorbing_conditions above)</span></span><br><span class="line">absorbbottom                    = .false.</span><br><span class="line">absorbright                     = .true.</span><br><span class="line">absorbtop                       = .true.</span><br><span class="line">absorbleft                      = .true.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">define the different regions of the model <span class="keyword">in</span> the (nx,nz) spectral-element mesh</span></span><br><span class="line">nbregions                       = 8              # then set below the different regions and model number for each region</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">format of each line: nxmin nxmax nzmin nzmax material_number</span></span><br><span class="line">1 10  1 20 1</span><br><span class="line">11 20  1 20 2</span><br><span class="line">21 30  1 20 1</span><br><span class="line">31 40  1 20 2</span><br><span class="line">1 10  21 40 2</span><br><span class="line">11 20  21 40 1</span><br><span class="line">21 30  21 40 2</span><br><span class="line">31 40  21 40 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Display parameters</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">interval at <span class="built_in">which</span> we output time step info and max of norm of displacement</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(every how many time steps we display information about the simulation. costly, <span class="keyword">do</span> not use a very small value)</span></span><br><span class="line">NTSTEP_BETWEEN_OUTPUT_INFO      = 400</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">meshing output</span></span><br><span class="line">output_grid_Gnuplot             = .false.        # generate a GNUPLOT file containing the grid, and a script to plot it</span><br><span class="line">output_grid_ASCII               = .false.        # dump the grid in an ASCII text file consisting of a set of X,Y,Z points or not</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to plot total energy curves, <span class="keyword">for</span> instance to monitor how CPML absorbing layers behave;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">should be turned OFF <span class="keyword">in</span> most cases because a bit expensive</span></span><br><span class="line">OUTPUT_ENERGY                   = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">every how many time steps we compute energy (<span class="built_in">which</span> is a bit expensive to compute)</span></span><br><span class="line">NTSTEP_BETWEEN_OUTPUT_ENERGY    = 10</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compute the field int_0^t v^2 dt <span class="keyword">for</span> a <span class="built_in">set</span> of GLL points and write it to file. Use</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the script utils/visualisation/plotIntegratedEnergyFile.py to watch. It is refreshed at the same time than the seismograms</span></span><br><span class="line">COMPUTE_INTEGRATED_ENERGY_FIELD = .false.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Movies/images/snaphots visualizations</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#-----------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">every how many time steps we draw JPEG or PostScript pictures of the simulation</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and/or we dump results of the simulation as ASCII or binary files (costly, <span class="keyword">do</span> not use a very small value)</span></span><br><span class="line">NTSTEP_BETWEEN_OUTPUT_IMAGES    = 200</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">minimum amplitude kept <span class="keyword">in</span> % <span class="keyword">for</span> the JPEG and PostScript snapshots; amplitudes below that are muted</span></span><br><span class="line">cutsnaps                        = 1.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">### for JPEG color images ####</span></span></span><br><span class="line">output_color_image              = .true.         # output JPEG color image of the results every NTSTEP_BETWEEN_OUTPUT_IMAGES time steps or not</span><br><span class="line">imagetype_JPEG                  = 3              # display 1=displ_Ux 2=displ_Uz 3=displ_norm 4=veloc_Vx 5=veloc_Vz 6=veloc_norm 7=accel_Ax 8=accel_Az 9=accel_norm 10=pressure</span><br><span class="line">factor_subsample_image          = 1.0d0          # (double precision) factor to subsample or oversample (if set to e.g. 0.5) color images output by the code (useful for very large models, or to get nicer looking denser pictures)</span><br><span class="line">USE_CONSTANT_MAX_AMPLITUDE      = .false.        # by default the code normalizes each image independently to its maximum; use this option to use the global maximum below instead</span><br><span class="line">CONSTANT_MAX_AMPLITUDE_TO_USE   = 1.17d4         # constant maximum amplitude to use for all color images if the above USE_CONSTANT_MAX_AMPLITUDE option is true</span><br><span class="line">POWER_DISPLAY_COLOR             = 0.30d0         # non linear display to enhance small amplitudes in JPEG color images</span><br><span class="line">DRAW_SOURCES_AND_RECEIVERS      = .true.         # display sources as orange crosses and receivers as green squares in JPEG images or not</span><br><span class="line">DRAW_WATER_IN_BLUE              = .true.         # display acoustic layers as constant blue in JPEG images, because they likely correspond to water in the case of ocean acoustics or in the case of offshore oil industry experiments (if off, display them as greyscale, as for elastic or poroelastic elements, for instance for acoustic-only oil industry models of solid media)</span><br><span class="line">USE_SNAPSHOT_NUMBER_IN_FILENAME = .false.        # use snapshot number in the file name of JPEG color snapshots instead of the time step (for instance to create movies in an easier way later)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">### for PostScript snapshots ####</span></span></span><br><span class="line">output_postscript_snapshot      = .false.        # output Postscript snapshot of the results every NTSTEP_BETWEEN_OUTPUT_IMAGES time steps or not</span><br><span class="line">imagetype_postscript            = 1              # display 1=displ vector 2=veloc vector 3=accel vector; small arrows are displayed for the vectors</span><br><span class="line">meshvect                        = .false.        # display mesh on PostScript plots or not</span><br><span class="line">modelvect                       = .false.        # display velocity model on PostScript plots or not</span><br><span class="line">boundvect                       = .true.         # display boundary conditions on PostScript plots or not</span><br><span class="line">interpol                        = .true.         # interpolation of the PostScript display on a regular grid inside each spectral element, or use the non-evenly spaced GLL points</span><br><span class="line">pointsdisp                      = 6              # number of points in each direction for interpolation of PostScript snapshots (set to 1 for lower-left corner only)</span><br><span class="line">subsamp_postscript              = 1              # subsampling of background velocity model in PostScript snapshots</span><br><span class="line">sizemax_arrows                  = 1.d0           # maximum size of arrows on PostScript plots in centimeters</span><br><span class="line">US_LETTER                       = .false.        # use US letter or European A4 paper for PostScript plots</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">### for wavefield dumps ####</span></span></span><br><span class="line">output_wavefield_dumps          = .false.        # output wave field to a text file (creates very big files)</span><br><span class="line">imagetype_wavefield_dumps       = 1              # display 1=displ vector 2=veloc vector 3=accel vector 4=pressure</span><br><span class="line">use_binary_for_wavefield_dumps  = .false.        # use ASCII or single-precision binary format for the wave field dumps</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ability to run several calculations (several earthquakes)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> an embarrassingly-parallel fashion from within the same run;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">this can be useful when using a very large supercomputer to compute</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">many earthquakes <span class="keyword">in</span> a catalog, <span class="keyword">in</span> <span class="built_in">which</span> <span class="keyword">case</span> it can be better from</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a batch job submission point of view to start fewer and much larger <span class="built_in">jobs</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">each of them computing several earthquakes <span class="keyword">in</span> parallel.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">To turn that option on, <span class="built_in">set</span> parameter NUMBER_OF_SIMULTANEOUS_RUNS to a value greater than 1.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">To implement that, we create NUMBER_OF_SIMULTANEOUS_RUNS MPI sub-communicators,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">each of them being labeled <span class="string">"my_local_mpi_comm_world"</span>, and we use them</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> all the routines <span class="keyword">in</span> <span class="string">"src/shared/parallel.f90"</span>, except <span class="keyword">in</span> MPI_ABORT() because <span class="keyword">in</span> that <span class="keyword">case</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">we need to <span class="built_in">kill</span> the entire run.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">When that option is on, of course the number of processor cores used to start</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the code <span class="keyword">in</span> the batch system must be a multiple of NUMBER_OF_SIMULTANEOUS_RUNS,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">all the individual runs must use the same number of processor cores,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">which</span> as usual is NPROC <span class="keyword">in</span> the Par_file,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and thus the total number of processor cores to request from the batch system</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">should be NUMBER_OF_SIMULTANEOUS_RUNS * NPROC.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">All the runs to perform must be placed <span class="keyword">in</span> directories called run0001, run0002, run0003 and so on</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(with exactly four digits).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Imagine you have 10 independent calculations to do, each of them on 100 cores; you have three options:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 1/ submit 10 jobs to the batch system</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 2/ submit a single job on 1000 cores to the batch, and in that script create a sub-array of jobs to start 10 jobs,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">each running on 100 cores (see e.g. http://www.schedmd.com/slurmdocs/job_array.html )</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 3/ submit a single job on 1000 cores to the batch, start SPECFEM2D on 1000 cores, create 10 sub-communicators,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> into one of 10 subdirectories (called e.g. run0001, run0002,... run0010) depending on the sub-communicator</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">your MPI rank belongs to, and run normally on 100 cores using that sub-communicator.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The option below implements 3/.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">NUMBER_OF_SIMULTANEOUS_RUNS     = 1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">if</span> we perform simultaneous runs <span class="keyword">in</span> parallel, <span class="keyword">if</span> only the <span class="built_in">source</span> and receivers vary between these runs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">but not the mesh nor the model (velocity and density) <span class="keyword">then</span> we can also <span class="built_in">read</span> the mesh and model files</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">from a single run <span class="keyword">in</span> the beginning and broadcast them to all the others; <span class="keyword">for</span> a large number of simultaneous</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">runs <span class="keyword">for</span> instance when solving inverse problems iteratively this can DRASTICALLY reduce I/Os to disk <span class="keyword">in</span> the solver</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(by a <span class="built_in">factor</span> equal to NUMBER_OF_SIMULTANEOUS_RUNS), and reducing I/Os is crucial <span class="keyword">in</span> the <span class="keyword">case</span> of huge runs.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Thus, always <span class="built_in">set</span> this option to .<span class="literal">true</span>. <span class="keyword">if</span> the mesh and the model are the same <span class="keyword">for</span> all simultaneous runs.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">In that <span class="keyword">case</span> there is no need to duplicate the mesh and model file database (the content of the DATABASES_MPI</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">directories) <span class="keyword">in</span> each of the run0001, run0002,... directories, it is sufficient to have one <span class="keyword">in</span> run0001</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and the code will broadcast it to the others)</span></span><br><span class="line">BROADCAST_SAME_MESH_AND_MODEL   = .true.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-----------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> to <span class="literal">true</span> to use GPUs</span></span><br><span class="line">GPU_MODE                        = .false.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="SOURCE"><a href="#SOURCE" class="headerlink" title="SOURCE"></a>SOURCE</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Source 1</span></span></span><br><span class="line">source_surf                     = .false.        # source inside the medium, or source automatically moved exactly at the surface by the solver</span><br><span class="line">xs                              = 96000.00      # source location x in meters</span><br><span class="line">zs                              = 180000.00      # source location z in meters (zs is ignored if source_surf is set to true, it is replaced with the topography height)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Source type parameters:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 1 = elastic force or acoustic pressure</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 2 = moment tensor</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">or Initial field <span class="built_in">type</span> (when initialfield <span class="built_in">set</span> <span class="keyword">in</span> Par_file):</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For a plane wave including converted and reflected waves at the free surface:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 1 = P wave,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 2 = S wave,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 3 = Rayleigh wave</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For a plane wave without converted nor reflected waves at the free surface, i.e. with the incident wave only:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 4 = P wave,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 5 = S wave</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For initial mode displacement:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 6 = mode (2,3) of a rectangular membrane</span></span><br><span class="line">source_type                     = 1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Source time <span class="keyword">function</span>:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">In the <span class="keyword">case</span> of a <span class="built_in">source</span> located <span class="keyword">in</span> an acoustic medium,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to get pressure <span class="keyword">for</span> a Ricker <span class="keyword">in</span> the seismograms, here we need to <span class="keyword">select</span> a Gaussian <span class="keyword">for</span> the potential Chi</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">used as a <span class="built_in">source</span>, rather than a Ricker, because pressure = - Chi_dot_dot.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This is <span class="literal">true</span> both when USE_TRICK_FOR_BETTER_PRESSURE is <span class="built_in">set</span> to .<span class="literal">true</span>. or to .<span class="literal">false</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Options:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 1 = second derivative of a Gaussian (a.k.a. Ricker),</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 2 = first derivative of a Gaussian,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 3 = Gaussian,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 4 = Dirac,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 5 = Heaviside (4 and 5 will produce noisy recordings because of frequencies above the mesh resolution <span class="built_in">limit</span>),</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 6 = ocean acoustics <span class="built_in">type</span> I,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 7 = ocean acoustics <span class="built_in">type</span> II,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 8 = external <span class="built_in">source</span> time <span class="keyword">function</span> = 8 (<span class="built_in">source</span> <span class="built_in">read</span> from file),</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 9 = burst,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">10 = Sinus <span class="built_in">source</span> time <span class="keyword">function</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">11 = Marmousi Ormsby wavelet</span></span><br><span class="line">time_function_type              = 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If time_function_type == 8, enter below the custom <span class="built_in">source</span> file to <span class="built_in">read</span> (two columns file with time and amplitude) :</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(For the moment dt must be equal to the dt of the simulation. File name cannot exceed 150 characters)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">IMPORTANT: <span class="keyword">do</span> NOT put quote signs around the file name, just put the file name itself otherwise the run will stop</span></span><br><span class="line">name_of_source_file             = ""             # Only for option 8 : file containing the source wavelet</span><br><span class="line">burst_band_width                = 0.             # Only for option 9 : band width of the burst</span><br><span class="line">f0                              = 1.400e-02      # dominant source frequency (Hz) if not Dirac or Heaviside</span><br><span class="line">tshift                          = 0.000e+00      # time shift when multi sources (if one source, must be zero)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Force source</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">angle of the <span class="built_in">source</span> (<span class="keyword">for</span> a force only); <span class="keyword">for</span> a plane wave, this is the incidence angle; <span class="keyword">for</span> moment tensor sources this is unused</span></span><br><span class="line">anglesource                     = 0.00</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Moment tensor</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The components of a moment tensor <span class="built_in">source</span> must be given <span class="keyword">in</span> N.m, not <span class="keyword">in</span> dyne.cm as <span class="keyword">in</span> the DATA/CMTSOLUTION <span class="built_in">source</span> file of the 3D version of the code.</span></span><br><span class="line">Mxx                             = 1.000000       # Mxx component (for a moment tensor source only)</span><br><span class="line">Mzz                             = -1.000000      # Mzz component (for a moment tensor source only)</span><br><span class="line">Mxz                             = 0.000000       # Mxz component (for a moment tensor source only)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Amplification (factor to amplify source time function)</span></span></span><br><span class="line">factor                          = 1.000e+10      # amplification factor</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Moving source parameters</span></span></span><br><span class="line">vx                              = 0.0            # Horizontal source velocity (m/s)</span><br><span class="line">vz                              = 0.0            # Vertical source velocity (m/s)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>



<h2 id="interfaces-dat"><a href="#interfaces-dat" class="headerlink" title="interfaces.dat"></a>interfaces.dat</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">number of interfaces</span></span><br><span class="line"> 2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># for each interface below, we give the number of points and then x,z for each point</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># interface number 1 (bottom of the mesh)</span></span></span><br><span class="line"> 2</span><br><span class="line"> 0.0 0.0</span><br><span class="line"> 480000.0 0.0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">interface number 5 (topography, top of the mesh)</span></span><br><span class="line"> 2</span><br><span class="line"> 0.0 180000.0</span><br><span class="line"> 480000.0 180000.0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># for each layer, we give the number of spectral elements in the vertical direction</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># layer number 1</span></span></span><br><span class="line"> 40</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>












                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">ZY</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://erbiaoger.github.io/2023/05/24/2023-05-24-seisflows/">http://erbiaoger.github.io/2023/05/24/2023-05-24-seisflows/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">ZY</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/seisflows/">
                                    <span class="chip bg-color">seisflows</span>
                                </a>
                            
                                <a href="/tags/inversion/">
                                    <span class="chip bg-color">inversion</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'Ov23lienOd1maZai6LR0',
        clientSecret: '8ee9facc6aa85b0771292953cc7a32d4cb1057b9',
        repo: 'gitalk',
        owner: 'erbiaoger',
        admin: "erbiaoger",
        id: '2023-05-24T00-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/05/24/2023-05-24-zi-xiang-guan/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/featureimages/13.jpg" class="responsive-img" alt="自相关">
                        
                        <span class="card-title">自相关</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-05-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ZY
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Mars/">
                        <span class="chip bg-color">Mars</span>
                    </a>
                    
                    <a href="/tags/technology/">
                        <span class="chip bg-color">technology</span>
                    </a>
                    
                    <a href="/tags/obspy/">
                        <span class="chip bg-color">obspy</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/05/22/2023-05-22-hvsr/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/medias/featureimages/13.jpg" class="responsive-img" alt="hvsr">
                        
                        <span class="card-title">hvsr</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-05-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ZY
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/seismic/">
                        <span class="chip bg-color">seismic</span>
                    </a>
                    
                    <a href="/tags/hvsr/">
                        <span class="chip bg-color">hvsr</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2022-2024</span>
            
            <a href="/about" target="_blank">Zhiyu Zhang</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/erbiaoger" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:erbiaoger@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=643747954" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 643747954" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/js/matery.js"></script>

    

    
    
    
        
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/others/sakura.js"><\/script>');
            }
        </script>
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?19982430";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="https://cdn.jsdelivr.net/gh/erbiaoger/erbiaoger.github.io/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
